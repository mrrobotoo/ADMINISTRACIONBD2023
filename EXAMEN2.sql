CREATE TABLE ALUMNOS1 (
    ID_ALUM NUMBER(10) PRIMARY KEY,
    NOM VARCHAR(50),
    APELL VARCHAR(50),
    FE_NACIMIENTO DATE 
);

DROP TABLE ALUMNOS1;

INSERT INTO ALUMNOS1 (ID_ALUM, NOM, APELL, FE_NACIMIENTO) VALUES (1, 'PABLO', 'HERNANDEZ MATA', TO_DATE('1995-03-14', 'YYYY-MM-DD'));
INSERT INTO ALUMNOS1 (ID_ALUM, NOM, APELL, FE_NACIMIENTO) VALUES (2, 'JEREMIAS', 'SANTO LOTE', TO_DATE('1993-07-12', 'YYYY-MM-DD'));
INSERT INTO ALUMNOS1 (ID_ALUM, NOM, APELL, FE_NACIMIENTO) VALUES (3, 'TERESA', 'LOMAS TRILLO', TO_DATE('1989-06-19', 'YYYY-MM-DD'));
INSERT INTO ALUMNOS1 (ID_ALUM, NOM, APELL, FE_NACIMIENTO) VALUES (4, 'MARTA', 'FUEGO GARCIA', TO_DATE('1992-11-23', 'YYYY-MM-DD'));
INSERT INTO ALUMNOS1 (ID_ALUM, NOM, APELL, FE_NACIMIENTO) VALUES (5, 'SERGIO', 'OT DIRMET', TO_DATE('1991-04-21', 'YYYY-MM-DD'));
INSERT INTO ALUMNOS1 (ID_ALUM, NOM, APELL, FE_NACIMIENTO) VALUES (7, 'CARMEN', 'DILMA PERNA', TO_DATE('1987-12-04', 'YYYY-MM-DD'));

CREATE TABLE PROFESORES1 (
    ID_PROF NUMBER(10) PRIMARY KEY,
    NOM VARCHAR(50),
    APELLI VARCHAR(50),
    FE_NACIMIENTO DATE 
);

INSERT INTO PROFESORES1 (ID_PROF, NOM, APELLI, FE_NACIMIENTO) VALUES (1, 'FEDERICO','GASCO DAZA', TO_DATE('1975-04-23','YYYY-MM-DD'));
INSERT INTO PROFESORES1 (ID_PROF, NOM, APELLI, FE_NACIMIENTO) VALUES (2, 'ANA','SAURA TRENZO', TO_DATE('1969-08-02','YYYY-MM-DD'));
INSERT INTO PROFESORES1 (ID_PROF, NOM, APELLI, FE_NACIMIENTO) VALUES (3, 'ROSA','HONROSA PEREZ', TO_DATE('1980-09-05','YYYY-MM-DD'));
INSERT INTO PROFESORES1 (ID_PROF, NOM, APELLI, FE_NACIMIENTO) VALUES (4, 'CARLOS','GARCIA MARTINEZ', TO_DATE('1985-05-24','YYYY-MM-DD'));


CREATE TABLE CURSOS2 (
    ID_CUR NUMBER(10) PRIMARY KEY,
    TITU VARCHAR(50),
    ID_PROF NUMBER,
    CONSTRAINT FK_PROF
    FOREIGN KEY (ID_PROF)
    REFERENCES PROFESORES1 (ID_PROF)
);

INSERT INTO CURSOS2 (ID_CUR, TITU, ID_PROF) VALUES (1,'PROGRAMACION PHP',3);
INSERT INTO CURSOS2 (ID_CUR, TITU, ID_PROF) VALUES (2,'MODELOS ABSTRACTO DE DATOS',3);
INSERT INTO CURSOS2 (ID_CUR, TITU, ID_PROF) VALUES (3,'SQL DESDE CERO',1);
INSERT INTO CURSOS2 (ID_CUR, TITU, ID_PROF) VALUES (4,'DIBUJO TECNICO',2);
INSERT INTO CURSOS2 (ID_CUR, TITU, ID_PROF) VALUES (5,'SQL AVANZADO',NULL);

CREATE TABLE ALUMNOS1_CURSOS1 (
    ID_ALUM NUMBER(10),
    ID_CUR NUMBER(10),
    
    CONSTRAINT FK_ALUM
    FOREIGN KEY (ID_ALUM)
    REFERENCES ALUMNOS1 (ID_ALUM),
    CONSTRAINT FK_CUR
    FOREIGN KEY (ID_CUR)
    REFERENCES CURSOS2 (ID_CUR)
);

INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (1,1);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (3,1);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (5,1);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (4,2);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (1,3);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (5,3);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (2,4);
INSERT INTO ALUMNOS1_CURSOS1 (ID_ALUM,ID_CUR) VALUES (7,4);

--CONSULTA QUE DE CONMMO RESULTADO TODA LA INF QUE EXISTE ENTRE PROFESORES Y CURSOS 
SELECT
  C.ID_CUR AS ID_CUR,
  C.TITU AS TITU,
  P.ID_PROF AS ID_PROF,
  P.NOM AS NOM,
  P.APELLI AS APELL,
  A.FE_NACIMIENTO AS FE_NACIMIENTO
FROM
  CURSOS2 C
JOIN PROFESORES1 P ON C.ID_PROF = P.ID_PROF
JOIN ALUMNOS1_CURSOS1 AC ON C.ID_CUR = AC.ID_CUR
JOIN ALUMNOS1 A ON AC.ID_ALUM = A.ID_ALUM;

--CONSULTA QUE MUESTRE LOS CURSOS Y LOS PROFESORES AUNNQUE EL CURSO NO TENGA PROF ASIGNADO

SELECT
  C.ID_CUR AS ID_CUR,
  C.TITU AS TITULO,
  COALESCE(P.ID_PROF, NULL) AS ID_PROF,
  COALESCE(P.NOM, NULL) AS NOM,
  COALESCE(P.APELLI, NULL) AS APELLIDOS,
  COALESCE(P.FE_NACIMIENTO, NULL) AS FE_NACIMIENTO
FROM
  CURSOS2 C
LEFT JOIN PROFESORES1 P ON C.ID_PROF = P.ID_PROF;



